#Область ПрограммныйИнтерфейс

#Область РегистрацияДанных

Процедура ЗарегистрироватьДобавлениеОбъекта(ТипОбъкта, ИмяОбъекта, ХЭШ, Данные) Экспорт 
	
	МенеджерЗаписи             = РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.ТипОбъкта   = ТипОбъкта;
	МенеджерЗаписи.ВидСобытия  = Перечисления.ЛК_ВидыСобытийСОбъектамиЛК.Добавление;
	МенеджерЗаписи.ХЭШ         = ХЭШ;
	МенеджерЗаписи.Статус      = Перечисления.ЛК_СтатусОбменаСЛК.Новый;
	МенеджерЗаписи.Данные      = Данные;
	МенеджерЗаписи.ДатаСобытия = ТекущаяДата();
	МенеджерЗаписи.ИмяОбъекта  = ИмяОбъекта;
	
	Попытка
		МенеджерЗаписи.Записать();
		
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Дебаг, 
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Информация,	
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта,
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьДобавлениеОбъекта"));

	Исключение
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта,
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьДобавлениеОбъекта",
																				ОписаниеОшибки()));
	КонецПопытки;

КонецПроцедуры

Процедура ЗарегистрироватьИзменениеОбъекта(ТипОбъкта, ИмяОбъекта, ХЭШ, Данные) Экспорт 
	
	МенеджерЗаписи             = РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.ТипОбъкта    = ТипОбъкта;
	МенеджерЗаписи.ВидСобытия  = Перечисления.ЛК_ВидыСобытийСОбъектамиЛК.Изменение;
	МенеджерЗаписи.ХЭШ         = ХЭШ;
	МенеджерЗаписи.Статус      = Перечисления.ЛК_СтатусОбменаСЛК.Новый;
	МенеджерЗаписи.Данные      = Данные;
	МенеджерЗаписи.ДатаСобытия = ТекущаяДата();
	МенеджерЗаписи.ИмяОбъекта  = ИмяОбъекта;
	
	Попытка
		МенеджерЗаписи.Записать();

		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Дебаг, 
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Информация,	
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьИзменениеОбъекта"));
	Исключение
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьИзменениеОбъекта",
																				ОписаниеОшибки()));
	КонецПопытки;
		
КонецПроцедуры

Процедура ЗарегистрироватьУдалениеОбъекта(ТипОбъкта, ИмяОбъекта, ХЭШ, Данные) Экспорт 
	
	МенеджерЗаписи             = РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.ТипОбъкта    = ТипОбъкта;
	МенеджерЗаписи.ВидСобытия  = Перечисления.ЛК_ВидыСобытийСОбъектамиЛК.Удаление;
	МенеджерЗаписи.ХЭШ         = ХЭШ;
	МенеджерЗаписи.Статус      = Перечисления.ЛК_СтатусОбменаСЛК.Новый;
	МенеджерЗаписи.Данные      = Данные;
	МенеджерЗаписи.ДатаСобытия = ТекущаяДата();
	МенеджерЗаписи.ИмяОбъекта  = ИмяОбъекта;
	
	Попытка	
		МенеджерЗаписи.Записать();
		
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Дебаг, 
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Информация,	
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьУдалениеОбъекта"));
	Исключение
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьУдалениеОбъекта",
																				ОписаниеОшибки()));
	КонецПопытки;
		
КонецПроцедуры

#КонецОбласти

#Область ИзменениеСтатуса

Процедура ЗарегистрироватьОшибкуОбработки(ИД, ТипОбъкта, ИмяОбъекта, ВидСобытия, ХЭШ, Данные, МестоВозникновения = "", Ошибка = "") Экспорт 
	
	МенеджерЗаписи             = РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.ТипОбъкта    = ТипОбъкта;
	МенеджерЗаписи.ВидСобытия  = ВидСобытия;
	МенеджерЗаписи.ХЭШ         = ХЭШ;
	МенеджерЗаписи.Статус      = Перечисления.ЛК_СтатусОбменаСЛК.Ошибка;
	МенеджерЗаписи.Данные      = Данные;
	МенеджерЗаписи.ДатаСобытия = ТекущаяДата();
	МенеджерЗаписи.ИД          = ИД;
	МенеджерЗаписи.ИмяОбъекта  = ИмяОбъекта;

	Попытка
		МенеджерЗаписи.Записать();
		
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				ИД,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				МестоВозникновения,
																				Ошибка));
	Исключение
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				ИД,
																				ТипОбъкта,
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьОшибкуОбработки",
																				ОписаниеОшибки()));
	КонецПопытки;
		
КонецПроцедуры

Процедура ЗарегистрироватьУспехОбработки(ИД, ТипОбъкта, ИмяОбъекта, ВидСобытия, ХЭШ, Данные) Экспорт 
	
	МенеджерЗаписи             = РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.ТипОбъкта    = ТипОбъкта;
	МенеджерЗаписи.ВидСобытия  = ВидСобытия;
	МенеджерЗаписи.ХЭШ         = ХЭШ;
	МенеджерЗаписи.Статус      = Перечисления.ЛК_СтатусОбменаСЛК.Выполнен;
	МенеджерЗаписи.Данные      = Данные;
	МенеджерЗаписи.ДатаСобытия = ТекущаяДата();
	МенеджерЗаписи.ИД		   = ИД;
	МенеджерЗаписи.ИмяОбъекта  = ИмяОбъекта;

	Попытка	
		МенеджерЗаписи.Записать();
		
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Дебаг, 
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Информация,	
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				ИД,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьУдалениеОбъекта"));	
	Исключение
		ЛК_Логирование.ДобавитьЗаписьВЛог(	ЛК_ОбменДаннымиПовтИсп.УровниЛога().Ошибка,
											ЛК_ОбменДаннымиПовтИсп.СобытияЛога().РегистрацияЗаданияОчередиОбмена, 
											ЛК_ОбменДаннымиПовтИсп.УровниСобытийЛога().Ошибка,			
											ЛК_Логирование.ДанныеJSONОбъектJSON(ЛК_Логирование.ТекущаяДатаЛК(),
																				ИД,
																				ТипОбъкта, 
																				ИмяОбъекта,
																				Данные, 
																				"РегистрыСведений.ЛК_ОчередьОбменаСЛКПроизвольнымиДанными.ЗарегистрироватьУспехОбработки",
																				ОписаниеОшибки()));
	КонецПопытки;
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти